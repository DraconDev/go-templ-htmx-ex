// Code generated by templ - DO NOT EDIT.

// templ: version: v0.3.960
package pages

//lint:file-ignore SA4006 This context is only used if a nested component is present.

import "github.com/a-h/templ"
import templruntime "github.com/a-h/templ/runtime"

//go:generate templ generate
func AuthCallbackContent() templ.Component {
	return templruntime.GeneratedTemplate(func(templ_7745c5c3_Input templruntime.GeneratedComponentInput) (templ_7745c5c3_Err error) {
		templ_7745c5c3_W, ctx := templ_7745c5c3_Input.Writer, templ_7745c5c3_Input.Context
		if templ_7745c5c3_CtxErr := ctx.Err(); templ_7745c5c3_CtxErr != nil {
			return templ_7745c5c3_CtxErr
		}
		templ_7745c5c3_Buffer, templ_7745c5c3_IsBuffer := templruntime.GetBuffer(templ_7745c5c3_W)
		if !templ_7745c5c3_IsBuffer {
			defer func() {
				templ_7745c5c3_BufErr := templruntime.ReleaseBuffer(templ_7745c5c3_Buffer)
				if templ_7745c5c3_Err == nil {
					templ_7745c5c3_Err = templ_7745c5c3_BufErr
				}
			}()
		}
		ctx = templ.InitializeContext(ctx)
		templ_7745c5c3_Var1 := templ.GetChildren(ctx)
		if templ_7745c5c3_Var1 == nil {
			templ_7745c5c3_Var1 = templ.NopComponent
		}
		ctx = templ.ClearChildren(ctx)
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 1, "<div class=\"max-w-2xl mx-auto text-center\"><div class=\"glass-card rounded-lg shadow-2xl p-8\"><div class=\"mb-6\"><div class=\"animate-spin rounded-full h-12 w-12 border-b-2 border-cyan-500 mx-auto glow-effect\"></div></div><h2 class=\"text-2xl font-bold text-white mb-4\">Setting up your session...</h2><p class=\"text-gray-300 mb-6\">Please wait while we authenticate you with Google.</p><div id=\"error-message\" class=\"hidden text-red-400 bg-red-900/50 border border-red-400/50 px-4 py-3 rounded mb-4\"></div><div id=\"success-message\" class=\"hidden text-green-400 bg-green-900/50 border border-green-400/50 px-4 py-3 rounded mb-4\"></div></div></div><script>\n\t\t// Function to parse URL fragment\n\t\tfunction parseFragment() {\n\t\t\tvar fragment = window.location.hash.substring(1); // Remove #\n\t\t\tvar params = {};\n\t\t\tif (fragment) {\n\t\t\t\tvar pairs = fragment.split('&');\n\t\t\t\tfor (var i = 0; i < pairs.length; i++) {\n\t\t\t\t\tvar pair = pairs[i].split('=');\n\t\t\t\t\tparams[decodeURIComponent(pair[0])] = decodeURIComponent(pair[1] || '');\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn params;\n\t\t}\n\n\t\t// Function to set session and redirect\n\t\tfunction setSessionAndRedirect() {\n\t\t\tvar params = parseFragment();\n\t\t\tvar accessToken = params['access_token'];\n\t\t\tvar refreshToken = params['refresh_token'];\n\t\t\t\n\t\t\t// DEBUG: Log all available tokens from URL fragment\n\t\t\tconsole.log('üîç DEBUG: URL Fragment Analysis:');\n\t\t\tconsole.log('üîç DEBUG: Full URL:', window.location.href);\n\t\t\tconsole.log('üîç DEBUG: Hash fragment:', window.location.hash);\n\t\t\tconsole.log('üîç DEBUG: Parsed params:', params);\n\t\t\tconsole.log('üîç DEBUG: Available keys:', Object.keys(params));\n\t\t\t\n\t\t\tfor (var key in params) {\n\t\t\t\tconsole.log('üîç DEBUG: ' + key + ' =', params[key] ? params[key].substring(0, 50) + '...' : 'null');\n\t\t\t}\n\t\t\t\n\t\t\tconsole.log('üîç DEBUG: access_token found:', !!accessToken);\n\t\t\tconsole.log('üîç DEBUG: refresh_token found:', !!refreshToken);\n\t\t\t\n\t\t\tif (!accessToken) {\n\t\t\t\tshowError('No access token found in URL. Please try logging in again.');\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// DEBUG: Log what we're about to send\n\t\t\tvar requestBody = { token: accessToken };\n\t\t\tif (refreshToken) {\n\t\t\t\trequestBody.refresh_token = refreshToken;\n\t\t\t}\n\t\t\tconsole.log('üîç DEBUG: Sending request body:', {\n\t\t\t\thasAccessToken: !!accessToken,\n\t\t\t\thasRefreshToken: !!refreshToken,\n\t\t\t\taccessTokenLength: accessToken ? accessToken.length : 0,\n\t\t\t\trefreshTokenLength: refreshToken ? refreshToken.length : 0\n\t\t\t});\n\n\t\t\t// Set session cookie via server endpoint\n\t\t\tfetch('/api/auth/set-session', {\n\t\t\t\tmethod: 'POST',\n\t\t\t\theaders: {\n\t\t\t\t\t'Content-Type': 'application/json',\n\t\t\t\t},\n\t\t\t\tbody: JSON.stringify(requestBody)\n\t\t\t})\n\t\t\t.then(response => {\n\t\t\t\tconsole.log('üîç DEBUG: Set session response status:', response.status);\n\t\t\t\treturn response.text().then(text => {\n\t\t\t\t\tconsole.log('üîç DEBUG: Response body:', text);\n\t\t\t\t\treturn { ok: response.ok, status: response.status, text: text };\n\t\t\t\t});\n\t\t\t})\n\t\t\t.then(result => {\n\t\t\t\tif (result.ok) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tvar data = JSON.parse(result.text);\n\t\t\t\t\t\tconsole.log('üîç DEBUG: Parsed response data:', data);\n\t\t\t\t\t\tshowSuccess('Authentication successful! Redirecting to home...');\n\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\twindow.location.href = '/';\n\t\t\t\t\t\t}, 1000);\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tconsole.log('üîç DEBUG: Could not parse response JSON');\n\t\t\t\t\t\tshowSuccess('Authentication successful! Redirecting to home...');\n\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\twindow.location.href = '/';\n\t\t\t\t\t\t}, 1000);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthrow new Error('Failed to set session: ' + result.text);\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch(error => {\n\t\t\t\tconsole.error('üîç DEBUG: Error details:', error);\n\t\t\t\tshowError('Error: ' + error.message);\n\t\t\t});\n\t\t}\n\n\t\tfunction showError(message) {\n\t\t\tvar errorDiv = document.getElementById('error-message');\n\t\t\terrorDiv.textContent = message;\n\t\t\terrorDiv.classList.remove('hidden');\n\t\t}\n\n\t\tfunction showSuccess(message) {\n\t\t\tvar successDiv = document.getElementById('success-message');\n\t\t\tsuccessDiv.textContent = message;\n\t\t\tsuccessDiv.classList.remove('hidden');\n\t\t}\n\n\t\t// Run when page loads\n\t\tsetSessionAndRedirect();\n\t</script>")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		return nil
	})
}

var _ = templruntime.GeneratedTemplate
